{% extends "base.html" %}

{% block header %}
    <link rel="stylesheet" href="/static/style.css">
    <!-- Inclure la bibliothèque Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

{% endblock %}

{% block body %}
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Formulaire et liste de sélection dans une div -->
    <div class="form-container">
        <form id="rueForm" action="/nextrequest" method="POST">
            <!-- Label pour la sélection de la rue -->
            <label for="rue">Rue:</label>
            <!-- Sélecteur de ville -->
            <select id="rue" name="rue">
                <!-- Option par défaut -->
                <option value="None" selected>Choisir la rue</option>
                <!-- Options pour les différentes villes -->
                {% for item in rue %}
                    <option>{{ item[0] }}</option>
                {% endfor %}
            </select>

            <!-- Label et champs pour les dates -->
            <div>
                <label for="start_date">Date de début :</label>
                <input type="date" id="start_date" name="start_date" required>
                <br>

                <label for="end_date">Date de fin :</label>
                <input type="date" id="end_date" name="end_date" required>
                <br>

                <label for="heure_debut">Choisissez une heure de début :</label>
                <input type="time" id="heure_debut" name="heure_debut">
                <br>

                <label for="heure_fin">Choisissez une heure de fin :</label>
                <input type="time" id="heure_fin" name="heure_fin">
                <br>
            </div>

            <!-- Bouton de soumission -->
            <input type="submit" value="Valider">
        </form>


    </div>

    <!-- Div pour le graphique -->
    <div class="chart-container">
        <h2>
        {% for item in ville_info %}
            {{ item }}
        {% endfor %}
         </h2>
        <canvas id="myChart" width="600" height="400"></canvas>
        <script>
        // Récupérer les données passées depuis Flask
        var intList = {{ int_list | tojson | safe }};
        var strList = {{ str_list | tojson | safe }};

        // Créer un tableau de labels pour l'axe des ordonnées (y)
        var labels = strList;

        // Créer un tableau de données pour l'axe des abscisses (x)
        var data = intList;

        // Créer un contexte pour le canevas
        var ctx = document.getElementById('myChart').getContext('2d');

        // Créer le graphique
        var myChart = new Chart(ctx, {
            type: 'bar', // Type de graphique (barres)
            data: {
                labels: labels, // Données pour l'axe des ordonnées (y)
                datasets: [{
                    label: 'Valeurs', // Légende
                    data: data, // Données pour l'axe des abscisses (x)
                    backgroundColor: 'rgba(75, 192, 192, 0.2)', // Couleur de fond des barres
                    borderColor: 'rgba(75, 192, 192, 1)', // Couleur de bordure des barres
                    borderWidth: 1 // Largeur de la bordure
                }]
            },
            options: {
                scales: {
                    y: {
                        beginAtZero: true // Commencer l'axe des ordonnées à zéro
                    }
                }
            }
        });
    </script>
    </div>


{% endblock %}

{% block footer %}
{% endblock %}
